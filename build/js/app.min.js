"use strict";document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector(".btn-primary"),e=document.querySelector(".table-list"),n=document.querySelector("#tel"),o=document.querySelector("#name"),s=document.querySelector(".error-phone"),r=document.querySelector(".error-name");document.querySelector(".form");let a=!1;let l=(()=>{const t=localStorage.getItem("app_state");if(!t)return[];try{return console.log("data",JSON.parse(t)),JSON.parse(t)}catch(t){return console.error("Ошибка при получении данных из localStorage"),[]}})();const d=e=>{e.addEventListener("input",(({target:e})=>{var n;"tel"===e.type?(t.disabled=!1,n=e.value,/^(\+7|7|8)?[\s\-]?\(?[489][0-9]{2}\)?[\s\-]?[0-9]{3}[\s\-]?[0-9]{2}[\s\-]?[0-9]{2}$/.test(n)?s.classList.remove("show"):s.classList.add("show")):""===e.value.trim()?r.classList.add("show"):r.classList.remove("show")}))},c=(t,e,n)=>{t.addEventListener("click",(()=>{let t="_"+Math.random().toString(36).substr(2,9);s.classList.remove("show"),l.push({name:n.value,phone:e.value,id:t}),e.value="",n.value="",u(),i()}))},i=()=>{localStorage.setItem("app_state",JSON.stringify(l))},u=()=>{e.innerHTML=l.map(((t,e)=>`<tr class="list-item" data-id="${t.id}">\n            <th scope="row">${e+1}</th>\n            <td><input type="text" class="td-input" value="${t.name}" id="td-name"/></td>\n            <td><input type="tel" class="td-input" value="${t.phone}" id="td-phone"/></td>\n            <td class="btn-wrap">\n                <button type="button" class="button edit-button">Edit</button>\n                <button type="button" class="button btn-close">Delete</button>\n            </td>\n        </tr>`)).join(""),(()=>{const t=document.querySelectorAll(".edit-button");let e=document.querySelectorAll("#td-name"),n=document.querySelectorAll("#td-phone");t.forEach(((t,o)=>{t.addEventListener("click",(s=>{a=!a,t.innerHTML=a?"Save":"Edit",e[o].classList.add("active"),n[o].classList.add("active");let r=s.target.closest(".list-item").getAttribute("data-id");a&&(l=l.filter((t=>t.id!==r)),c(t,n[o],e[o]),d(n[o]),d(e[o]),i())}))}))})(),document.querySelectorAll(".btn-close").forEach(((t,e)=>{t.addEventListener("click",(t=>{let e=t.target.closest(".list-item"),n=e.getAttribute("data-id");l=l.filter((t=>t.id!==n)),e.remove(),i()}))})),d(n),d(o),t.disabled=!0};c(t,n,o),u()}));